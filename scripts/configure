#!/bin/sh
set A=""

# Install dependencies
if [ -f /etc/arch-release ]; then
    echo "This is Arch Linux."
    sudo pacman --needed -S cmake gtest ninja
else
  sudo apt update
  sudo apt install software-properties-common -y
  sudo add-apt-repository ppa:ubuntu-toolchain-r/ppa -y
  sudo apt update
  sudo apt install gcc-15 g++-15 cmake build-essential ninja-build -y
  A="-DCMAKE_C_COMPILER=gcc-15 -DCMAKE_CXX_COMPILER=g++-15"
fi

mkdir CBuild_CACHE
cd CBuild_CACHE

cmake .. $A -DCMAKE_BUILD_TYPE=Release -G "Ninja" -DCMAKE_INSTALL_PREFIX=/usr -DCI_BUILD=1